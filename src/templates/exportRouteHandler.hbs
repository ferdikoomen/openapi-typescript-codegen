{{#each services}}
import { I{{{pascalCase name}}}{{{@root.postfix}}} } from './i-{{{@root.serverDirName}}}/{{{hyphenCase name}}}-{{{hyphenCase @root.postfix}}}';
{{/each}}
import {
  {{{transformReqFuncName}}} as transformRequest,
  {{{transformResFuncName}}} as transformResponse
} from '{{{transformFuncPath}}}';
import { inject, injectable } from 'tsyringe';

@injectable()
export class RouteHandler {
  constructor(
    {{#each services}}
    @inject('I{{{pascalCase name}}}{{{@root.postfix}}}') private {{{camelCase name}}}: I{{{pascalCase name}}}{{{@root.postfix}}},
    {{/each}}
  ) { }

  private applyTransforms(req, reply, handlerFunc) {
    const transformedRequest = transformRequest(req);
    const handlerResponse = handlerFunc(transformedRequest);
    const transformedResponse = transformResponse(handlerResponse, reply);
    return transformedResponse;
  }

{{#each services}}
{{#each operations}}
  {{{name}}} = (req, reply) => this.applyTransforms(req, reply, this.{{{camelCase service}}}.{{{name}}});
{{/each}}
{{/each}}
}
